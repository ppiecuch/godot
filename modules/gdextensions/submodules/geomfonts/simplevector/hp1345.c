/*************************************************************************/
/*  hp1345.c                                                             */
/*************************************************************************/
/*                       This file is part of:                           */
/*                           GODOT ENGINE                                */
/*                      https://godotengine.org                          */
/*************************************************************************/
/* Copyright (c) 2007-2022 Juan Linietsky, Ariel Manzur.                 */
/* Copyright (c) 2014-2022 Godot Engine contributors (cf. AUTHORS.md).   */
/*                                                                       */
/* Permission is hereby granted, free of charge, to any person obtaining */
/* a copy of this software and associated documentation files (the       */
/* "Software"), to deal in the Software without restriction, including   */
/* without limitation the rights to use, copy, modify, merge, publish,   */
/* distribute, sublicense, and/or sell copies of the Software, and to    */
/* permit persons to whom the Software is furnished to do so, subject to */
/* the following conditions:                                             */
/*                                                                       */
/* The above copyright notice and this permission notice shall be        */
/* included in all copies or substantial portions of the Software.       */
/*                                                                       */
/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,       */
/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF    */
/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.*/
/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY  */
/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,  */
/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE     */
/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                */
/*************************************************************************/

// HP1345A digital vector display character generator.
//
// http://phk.freebsd.dk/hacks/Wargames/index.html

#include "core/int_types.h"
#include "core/variant.h"
#include "scene/resources/mesh.h"

#define HP1345_ASCENT 18
#define HP1345_DESCENT 8
#define HP1345_ASPECT 0.75
#define HP1345_HEIGHT (HP1345_ASCENT + HP1345_DESCENT)
#define HP1345_WIDTH (HP1345_HEIGHT * HP1345_ASPECT)

//  +-------+  (18)
//  |       |
//  |       |
// -+-------+- (0)
//  |       |
//  +-------+  (-8)
// (0)     (18)

#define F false
#define T true

static bool hp1345_ops[] = { F, T, T, T, T, T, F, T, T, T, T, T, F, T, F, T, T, T, F, T, T, T, T, T, T, F, T, T, T, T, T, T, T, F, T, T, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, T, T, T, T, F, T, T, F, T, F, T, T, F, T, F, T, T, F, T, F, T, T, F, T, F, T, T, T, F, T, F, T, F, T, T, T, F, T, T, T, F, T, F, T, T, T, F, T, F, T, T, T, T, T, T, T, T, F, T, T, T, T, T, T, T, T, T, F, T, T, T, T, T, T, T, T, F, T, F, T, F, T, T, F, T, T, T, T, T, T, T, T, T, T, F, T, F, T, F, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, T, T, T, T, T, T, T, F, T, F, T, F, T, T, T, T, F, T, T, T, T, F, T, T, T, T, T, T, T, T, F, T, T, F, T, T, T, F, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, T, F, T, F, T, T, F, T, F, T, F, T, T, T, T, T, T, T, T, F, T, F, T, T, F, T, T, T, T, T, T, T, F, T, T, T, T, T, T, F, T, T, T, T, T, F, T, T, T, F, T, T, T, T, T, T, T, T, T, F, T, T, T, T, T, T, T, T, T, T, F, T, T, F, T, T, T, T, T, T, T, T, T, T, T, T, T, T, T, F, T, T, T, T, T, T, T, T, T, T, F, T, F, T, F, T, T, F, T, F, T, T, F, T, F, T, F, T, T, F, T, T, T, T, T, T, F, T, F, T, T, T, T, T, T, T, T, T, T, T, F, T, T, F, T, F, T, T, T, T, T, T, F, T, T, T, T, F, T, T, T, T, T, T, T, F, T, T, T, T, T, T, F, T, T, F, T, F, T, F, T, T, F, T, F, T, T, T, T, T, T, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, F, T, T, T, F, T, T, T, T, T, T, T, T, F, T, T, T, T, T, T, F, T, T, T, T, T, T, T, T, F, T, F, T, T, T, T, T, T, F, T, F, T, T, T, T, T, T, T, T, T, T, T, F, T, F, T, F, T, T, T, T, T, F, T, T, F, T, T, T, T, F, T, F, T, F, T, T, F, T, F, T, T, F, T, F, T, T, T, F, T, F, T, T, T, F, T, T, F, T, F, T, T, F, T, T, T, T, T, T, T, T, F, T, F, T, F, T, T, T, T, T, F, T, T, T, T, T, F, T, T, T, T, T, F, T, F, T, T, T, T, T, T, T, T, F, T, T, T, F, T, F, T, T, T, T, T, F, T, T, T, F, T, F, T, T, T, F, T, T, F, T, F, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, T, F, T, F, T, T, T, F, T, T, T, F, T, F, T, T, T, F, T, T, T, T, T, T, F, T, F, T, T, T, T, T, F, T, T, T, T, T, F, T, T, F, T, F, T, T, F, T, T, T, T, T, T, T, F, T, T, T, F, T, F, T, T, T, T, F, T, T, F, T, T, T, T, F, T, F, T, F, T, F, T, F, T, T, T, F, T, T, T, T, T, T, F, T, F, T, F, T, T, T, T, T, T, F, T, T, T, T, F, T, T, T, F, T, T, T, F, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, F, T, F, T, T, T, F, T, T, F, T, T, T, T, T, T, F, T, F, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, F, T, F, T, F, T, T, T, F, T, T, T, T, T, F, T, T, T, F, T, F, T, F, T, T, T, T, T, F, T, F, T, F, T, T, T, T, T, T, T, T, T, T, F, T, T, T, T, F, T, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, T, T, T, F, T, T, T, T, F, T, F, T, F, T, T, T, T, T, T, T, T, T, T, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, F, T, T, T, T, T, T, T, T, F, T, F, T, F, T, F, T, T, T, F, T, F, T, T, T, T, T, F, T, F, T, F, T, T, T, T, T, F, T, T, T };

#undef F
#undef T

static struct {
	int16_t x, y;
} hp1345_points[] = { { 19, 0 }, { 3, 0 }, { 0, 3 }, { 0, 24 }, { 3, 27 }, { 14, 27 }, { 20, 27 }, { 42, 27 }, { 45, 24 }, { 45, 3 }, { 42, 0 }, { 25, 0 }, { 13, 9 }, { 17, 27 }, { 15, 18 }, { 19, 18 }, { 21, 16 }, { 20, 9 }, { 22, 0 }, { 26, 18 }, { 30, 18 }, { 32, 16 }, { 31, 11 }, { 29, 9 }, { 24, 9 }, { 0, -7 }, { 1, 7 }, { 3, 16 }, { 7, 18 }, { 12, 16 }, { 12, 10 }, { 8, 8 }, { 2, 8 }, { 8, 8 }, { 11, 7 }, { 12, 3 }, { 9, 0 }, { 5, 0 }, { 1, 3 }, { 0, 0 }, { 0, 4 }, { 0, 0 }, { 0, -4 }, { 0, 0 }, { -4, 0 }, { 0, 0 }, { 4, 0 }, { -4, 0 }, { 4, 0 }, { 0, 4 }, { 0, -4 }, { 4, 4 }, { -4, -4 }, { 0, -5 }, { 0, 5 }, { -4, 4 }, { 4, -4 }, { 5, 0 }, { -5, 0 }, { -2, -5 }, { -5, -2 }, { -5, 2 }, { -2, 5 }, { 2, 5 }, { 5, 2 }, { 5, -2 }, { 2, -5 }, { -2, -5 }, { 0, 10 }, { 6, 18 }, { 12, 10 }, { 6, 18 }, { 6, 0 }, { 6, 3 }, { 0, 9 }, { 6, 15 }, { 0, 9 }, { 12, 9 }, { 0, 8 }, { 6, 0 }, { 12, 8 }, { 6, 0 }, { 6, 18 }, { 6, 3 }, { 12, 9 }, { 6, 15 }, { 0, 9 }, { 12, 9 }, { 0, 3 }, { 3, 0 }, { 6, 20 }, { 13, 20 }, { 3, 0 }, { 4, 12 }, { 9, 0 }, { 9, 12 }, { 0, 10 }, { 4, 12 }, { 9, 12 }, { 12, 14 }, { 0, 0 }, { 6, 15 }, { 12, 0 }, { 0, 0 }, { 0, -7 }, { 2, 11 }, { 1, 2 }, { 6, 0 }, { 10, 2 }, { 11, 11 }, { 10, 2 }, { 13, 0 }, { 6, 16 }, { 4, 18 }, { 4, 21 }, { 6, 23 }, { 9, 23 }, { 11, 21 }, { 11, 18 }, { 9, 16 }, { 6, 16 }, { 0, 0 }, { 4, 0 }, { 1, 7 }, { 1, 12 }, { 4, 16 }, { 9, 16 }, { 12, 12 }, { 12, 7 }, { 9, 0 }, { 13, 0 }, { 0, -7 }, { 3, 9 }, { 7, 12 }, { 11, 11 }, { 13, 8 }, { 13, 4 }, { 10, 0 }, { 5, 0 }, { 2, 3 }, { 0, 0 }, { 4, 0 }, { 2, 0 }, { 2, 18 }, { 0, 18 }, { 12, 18 }, { 12, 14 }, { 7, 0 }, { 2, 0 }, { 0, 4 }, { 0, 10 }, { 2, 15 }, { 5, 18 }, { 10, 18 }, { 12, 14 }, { 12, 8 }, { 10, 3 }, { 7, 0 }, { 0, 9 }, { 12, 9 }, { 0, 0 }, { 6, 10 }, { 0, 17 }, { 3, 18 }, { 9, 2 }, { 12, 0 }, { 6, 0 }, { 6, 0 }, { 6, 5 }, { 6, 18 }, { 3, 14 }, { 4, 18 }, { 7, 14 }, { 8, 18 }, { 2, 0 }, { 4, 18 }, { 8, 0 }, { 10, 18 }, { 0, 13 }, { 12, 13 }, { 0, 5 }, { 12, 5 }, { 0, 3 }, { 3, 1 }, { 9, 1 }, { 12, 3 }, { 12, 7 }, { 9, 9 }, { 3, 9 }, { 0, 11 }, { 0, 15 }, { 3, 17 }, { 9, 17 }, { 12, 15 }, { 6, 19 }, { 6, -1 }, { 0, 0 }, { 12, 18 }, { 6, 14 }, { 3, 10 }, { 0, 14 }, { 3, 18 }, { 6, 14 }, { 9, 8 }, { 12, 4 }, { 9, 0 }, { 6, 4 }, { 9, 8 }, { 12, 5 }, { 8, 0 }, { 2, 0 }, { 0, 4 }, { 9, 14 }, { 7, 18 }, { 3, 18 }, { 1, 14 }, { 12, 0 }, { 5, 14 }, { 7, 18 }, { 7, 18 }, { 12, -2 }, { 6, 4 }, { 6, 14 }, { 12, 20 }, { 0, -2 }, { 6, 4 }, { 6, 14 }, { 0, 20 }, { 3, 2 }, { 9, 16 }, { 3, 16 }, { 9, 2 }, { 0, 9 }, { 12, 9 }, { 6, 2 }, { 6, 16 }, { 0, 9 }, { 12, 9 }, { 4, -4 }, { 6, 1 }, { 6, 1 }, { 0, 9 }, { 12, 9 }, { 6, 0 }, { 6, 0 }, { 6, 0 }, { 0, 0 }, { 12, 18 }, { 1, 2 }, { 11, 16 }, { 12, 12 }, { 12, 6 }, { 9, 0 }, { 3, 0 }, { 0, 6 }, { 0, 12 }, { 3, 18 }, { 9, 18 }, { 12, 12 }, { 3, 0 }, { 9, 0 }, { 6, 0 }, { 6, 18 }, { 3, 15 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 12, 11 }, { 2, 5 }, { 0, 0 }, { 12, 0 }, { 0, 16 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 12, 11 }, { 9, 9 }, { 3, 9 }, { 9, 9 }, { 12, 7 }, { 12, 3 }, { 9, 0 }, { 3, 0 }, { 0, 2 }, { 9, 0 }, { 9, 18 }, { 0, 6 }, { 12, 6 }, { 0, 2 }, { 3, 0 }, { 9, 0 }, { 12, 2 }, { 12, 8 }, { 9, 10 }, { 3, 10 }, { 0, 9 }, { 2, 18 }, { 12, 18 }, { 0, 7 }, { 3, 10 }, { 9, 10 }, { 12, 7 }, { 12, 3 }, { 9, 0 }, { 3, 0 }, { 0, 3 }, { 0, 10 }, { 3, 15 }, { 7, 18 }, { 0, 18 }, { 12, 18 }, { 4, 0 }, { 3, 10 }, { 0, 13 }, { 0, 16 }, { 3, 19 }, { 9, 19 }, { 12, 16 }, { 12, 13 }, { 9, 10 }, { 3, 10 }, { 0, 7 }, { 0, 3 }, { 3, 0 }, { 9, 0 }, { 12, 3 }, { 12, 7 }, { 9, 10 }, { 5, 0 }, { 9, 3 }, { 12, 8 }, { 12, 15 }, { 9, 18 }, { 3, 18 }, { 0, 15 }, { 0, 11 }, { 3, 8 }, { 9, 8 }, { 12, 11 }, { 6, 4 }, { 6, 4 }, { 6, 14 }, { 6, 14 }, { 5, -4 }, { 7, 0 }, { 7, 0 }, { 7, 10 }, { 7, 10 }, { 12, 0 }, { 0, 9 }, { 12, 18 }, { 0, 4 }, { 12, 4 }, { 0, 14 }, { 12, 14 }, { 0, 0 }, { 12, 9 }, { 0, 18 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 12, 11 }, { 6, 7 }, { 6, 4 }, { 6, 0 }, { 6, 0 }, { 12, 2 }, { 10, 0 }, { 3, 0 }, { 0, 3 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 12, 6 }, { 5, 6 }, { 5, 13 }, { 12, 13 }, { 0, 0 }, { 6, 18 }, { 12, 0 }, { 3, 9 }, { 9, 9 }, { 0, 0 }, { 0, 18 }, { 9, 18 }, { 12, 15 }, { 12, 12 }, { 9, 9 }, { 0, 9 }, { 9, 9 }, { 12, 6 }, { 12, 3 }, { 9, 0 }, { 0, 0 }, { 12, 3 }, { 9, 0 }, { 3, 0 }, { 0, 3 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 0, 0 }, { 0, 18 }, { 9, 18 }, { 12, 15 }, { 12, 3 }, { 9, 0 }, { 0, 0 }, { 0, 0 }, { 0, 18 }, { 12, 18 }, { 0, 9 }, { 9, 9 }, { 0, 0 }, { 12, 0 }, { 0, 0 }, { 0, 18 }, { 12, 18 }, { 0, 9 }, { 9, 9 }, { 12, 15 }, { 9, 18 }, { 3, 18 }, { 0, 15 }, { 0, 3 }, { 3, 0 }, { 9, 0 }, { 12, 3 }, { 12, 8 }, { 5, 8 }, { 0, 0 }, { 0, 18 }, { 12, 0 }, { 12, 18 }, { 0, 9 }, { 12, 9 }, { 2, 0 }, { 10, 0 }, { 6, 0 }, { 6, 18 }, { 2, 18 }, { 10, 18 }, { 0, 2 }, { 3, 0 }, { 5, 0 }, { 8, 2 }, { 8, 18 }, { 4, 18 }, { 12, 18 }, { 0, 0 }, { 0, 18 }, { 12, 18 }, { 0, 6 }, { 3, 9 }, { 12, 0 }, { 0, 0 }, { 0, 18 }, { 0, 0 }, { 12, 0 }, { 0, 0 }, { 0, 18 }, { 6, 5 }, { 12, 18 }, { 12, 0 }, { 0, 0 }, { 0, 18 }, { 12, 0 }, { 12, 18 }, { 3, 0 }, { 0, 3 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 12, 3 }, { 9, 0 }, { 3, 0 }, { 0, 0 }, { 0, 18 }, { 9, 18 }, { 12, 15 }, { 12, 11 }, { 9, 8 }, { 0, 8 }, { 3, 0 }, { 0, 3 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 15 }, { 12, 3 }, { 9, 0 }, { 3, 0 }, { 7, 5 }, { 14, -2 }, { 0, 0 }, { 0, 18 }, { 9, 18 }, { 12, 15 }, { 12, 11 }, { 9, 8 }, { 0, 8 }, { 7, 8 }, { 12, 0 }, { 0, 2 }, { 3, 0 }, { 9, 0 }, { 12, 3 }, { 12, 6 }, { 9, 9 }, { 3, 9 }, { 0, 12 }, { 0, 15 }, { 3, 18 }, { 9, 18 }, { 12, 16 }, { 6, 0 }, { 6, 18 }, { 0, 18 }, { 12, 18 }, { 0, 18 }, { 0, 3 }, { 3, 0 }, { 9, 0 }, { 12, 3 }, { 12, 18 }, { 0, 18 }, { 6, 0 }, { 12, 18 }, { 0, 18 }, { 3, 0 }, { 6, 14 }, { 9, 0 }, { 12, 18 }, { 0, 0 }, { 12, 18 }, { 0, 18 }, { 12, 0 }, { 6, 0 }, { 6, 7 }, { 0, 18 }, { 6, 7 }, { 12, 18 }, { 0, 0 }, { 12, 18 }, { 0, 18 }, { 12, 0 }, { 0, 0 }, { 12, 20 }, { 6, 20 }, { 6, -2 }, { 12, -2 }, { 0, 18 }, { 12, 0 }, { 0, -2 }, { 6, -2 }, { 6, 20 }, { 0, 20 }, { 0, 7 }, { 6, 16 }, { 12, 7 }, { -18, -5 }, { 0, -5 }, { 5, 18 }, { 5, 18 }, { 7, 14 }, { 0, 10 }, { 5, 12 }, { 11, 10 }, { 11, 2 }, { 8, 0 }, { 4, 0 }, { 0, 2 }, { 0, 5 }, { 11, 6 }, { 11, 2 }, { 13, 0 }, { 0, 0 }, { 0, 18 }, { 0, 9 }, { 6, 11 }, { 12, 9 }, { 12, 2 }, { 6, 0 }, { 0, 2 }, { 11, 9 }, { 6, 11 }, { 0, 9 }, { 0, 2 }, { 6, 0 }, { 11, 2 }, { 12, 2 }, { 6, 0 }, { 0, 2 }, { 0, 9 }, { 6, 11 }, { 12, 9 }, { 12, 18 }, { 12, 0 }, { 0, 6 }, { 12, 7 }, { 9, 12 }, { 3, 12 }, { 0, 9 }, { 0, 2 }, { 3, 0 }, { 9, 0 }, { 12, 2 }, { 4, 0 }, { 4, 16 }, { 8, 18 }, { 12, 16 }, { 0, 9 }, { 8, 9 }, { 11, 2 }, { 6, 0 }, { 0, 2 }, { 0, 9 }, { 6, 11 }, { 11, 9 }, { 11, 11 }, { 11, -5 }, { 6, -7 }, { 0, -5 }, { 0, 0 }, { 0, 18 }, { 0, 9 }, { 6, 11 }, { 12, 9 }, { 12, 0 }, { 7, 0 }, { 7, 11 }, { 4, 11 }, { 7, 18 }, { 7, 18 }, { 0, -5 }, { 4, -7 }, { 8, -5 }, { 8, 11 }, { 8, 18 }, { 8, 18 }, { 0, 0 }, { 0, 18 }, { 0, 5 }, { 12, 11 }, { 4, 7 }, { 12, 0 }, { 3, 0 }, { 9, 0 }, { 6, 0 }, { 6, 18 }, { 3, 18 }, { 0, 0 }, { 0, 12 }, { 0, 9 }, { 4, 12 }, { 6, 9 }, { 6, 0 }, { 6, 9 }, { 10, 12 }, { 12, 9 }, { 12, 0 }, { 0, 0 }, { 0, 11 }, { 0, 8 }, { 6, 11 }, { 12, 8 }, { 12, 0 }, { 6, 0 }, { 0, 2 }, { 0, 9 }, { 6, 11 }, { 12, 9 }, { 12, 2 }, { 6, 0 }, { 0, -7 }, { 0, 11 }, { 0, 9 }, { 6, 11 }, { 12, 9 }, { 12, 2 }, { 6, 0 }, { 0, 2 }, { 11, 2 }, { 6, 0 }, { 0, 2 }, { 0, 9 }, { 6, 11 }, { 11, 9 }, { 11, 11 }, { 11, -6 }, { 13, -8 }, { 0, 0 }, { 0, 11 }, { 0, 8 }, { 6, 11 }, { 12, 8 }, { 0, 2 }, { 6, 0 }, { 12, 2 }, { 12, 5 }, { 0, 7 }, { 0, 10 }, { 6, 12 }, { 12, 10 }, { 12, 2 }, { 8, 0 }, { 4, 2 }, { 4, 18 }, { 0, 11 }, { 8, 11 }, { 0, 11 }, { 0, 2 }, { 6, 0 }, { 12, 2 }, { 12, 11 }, { 0, 11 }, { 6, 0 }, { 12, 11 }, { 0, 11 }, { 3, 0 }, { 6, 8 }, { 9, 0 }, { 12, 11 }, { 0, 0 }, { 11, 11 }, { 0, 11 }, { 11, 0 }, { 0, 11 }, { 7, 1 }, { 3, -7 }, { 12, 11 }, { 0, 11 }, { 12, 11 }, { 0, 0 }, { 12, 0 }, { 12, -2 }, { 7, 1 }, { 7, 6 }, { 4, 9 }, { 7, 12 }, { 7, 17 }, { 12, 20 }, { 6, 0 }, { 6, 6 }, { 6, 12 }, { 6, 18 }, { 0, -2 }, { 5, 1 }, { 5, 6 }, { 8, 9 }, { 5, 12 }, { 5, 17 }, { 0, 20 }, { 0, 0 }, { 0, 53 }, { 53, 53 }, { 53, 0 }, { 0, 0 }, { 0, 0 }, { 0, 18 }, { 12, 9 }, { 0, 0 }, { 0, 3 }, { 4, 3 }, { 4, 15 }, { 0, 15 }, { 0, 6 }, { 8, 6 }, { 8, 12 }, { 0, 12 }, { 0, 9 }, { 12, 9 }, { 0, 0 }, { -48, 0 }, { 0, -11 }, { -48, -11 }, { 0, -22 }, { -48, -22 }, { 0, -33 }, { -48, -33 }, { 0, -44 }, { -48, -44 }, { 0, -55 }, { -48, -55 }, { 0, 0 }, { 0, 9 }, { 0, 0 }, { 0, -9 }, { 0, 0 }, { -9, 0 }, { 0, 0 }, { 9, 0 }, { -9, 0 }, { 9, 0 }, { 0, 9 }, { 0, -9 }, { 0, 0 }, { 0, 39 }, { 53, 39 }, { 53, 0 }, { 0, 0 }, { 0, 0 }, { 0, 39 }, { 0, 40 }, { 0, 80 }, { 58, 80 }, { 58, 41 }, { 58, 40 }, { 58, 0 }, { 0, 0 }, { 5, 7 }, { 5, 40 }, { 5, 73 }, { 53, 73 }, { 53, 40 }, { 53, 7 }, { 5, 7 }, { 5, 40 }, { 53, 40 }, { 29, 73 }, { 29, 40 }, { 29, 7 }, { 31, 40 }, { 31, 7 }, { 33, 40 }, { 33, 7 }, { 35, 40 }, { 35, 7 }, { 37, 40 }, { 37, 7 }, { 39, 40 }, { 39, 7 }, { 41, 40 }, { 41, 7 }, { 43, 40 }, { 43, 7 }, { 45, 40 }, { 45, 7 }, { 47, 40 }, { 47, 7 }, { 49, 40 }, { 49, 7 }, { 51, 40 }, { 51, 7 }, { 0, -7 }, { 6, 0 }, { 0, -14 }, { 12, 0 }, { 0, -21 }, { 18, 0 }, { 0, -28 }, { 24, 0 }, { 0, -35 }, { 30, 0 }, { 0, -42 }, { 36, 0 }, { 0, -49 }, { 42, 0 }, { 0, -56 }, { 48, 0 }, { 0, -63 }, { 48, -7 }, { 3, -66 }, { 48, -14 }, { 9, -66 }, { 48, -21 }, { 15, -66 }, { 48, -28 }, { 21, -66 }, { 48, -35 }, { 27, -66 }, { 48, -42 }, { 33, -66 }, { 48, -49 }, { 39, -66 }, { 48, -56 }, { 45, -66 }, { 48, -63 }, { 54, 0 }, { 48, 7 }, { 60, 0 }, { 48, 14 }, { 66, 0 }, { 48, 21 }, { 72, 0 }, { 48, 28 }, { 78, 0 }, { 48, 35 }, { 84, 0 }, { 48, 42 }, { 90, 0 }, { 48, 49 }, { 96, 0 }, { 48, 56 }, { 96, 7 }, { 48, 63 }, { 96, 14 }, { 51, 66 }, { 96, 21 }, { 57, 66 }, { 96, 28 }, { 63, 66 }, { 96, 35 }, { 69, 66 }, { 96, 42 }, { 75, 66 }, { 96, 49 }, { 81, 66 }, { 96, 56 }, { 87, 66 }, { 96, 63 }, { 93, 66 }, { 48, 55 }, { 0, 55 }, { 48, 44 }, { 0, 44 }, { 48, 33 }, { 0, 33 }, { 48, 22 }, { 0, 22 }, { 48, 11 }, { 0, 11 }, { 6, 13 }, { 6, 18 }, { -17, 15 }, { -8, 18 }, { -17, 19 }, { -7, 15 }, { -17, 15 }, { -12, 18 }, { -7, 15 }, { -15, 17 }, { -15, 17 }, { -9, 17 }, { -9, 17 }, { -18, 23 }, { -15, 26 }, { -9, 23 }, { -6, 26 }, { 11, 9 }, { 5, 11 }, { 0, 9 }, { 0, 2 }, { 5, 0 }, { 11, 2 }, { 5, 0 }, { 5, -4 }, { 8, -7 }, { 5, -10 }, { 12, 0 }, { 12, 13 }, { 12, 18 }, { 12, 18 }, { 12, 3 }, { 6, 0 }, { 0, 3 }, { 0, 7 }, { 6, 10 }, { 6, 14 }, { 6, 18 }, { 6, 18 }, { 3, 9 }, { 9, 9 }, { 12, 17 }, { 8, 18 }, { 6, 15 }, { 6, 2 }, { 3, 0 }, { 0, 0 }, { 0, 2 }, { 3, 2 }, { 6, 0 }, { 9, 0 }, { 12, 2 }, { 0, 0 }, { 0, 58 }, { 58, 58 }, { 58, 0 }, { 0, 0 }, { 5, 5 }, { 5, 53 }, { 53, 53 }, { 53, 5 }, { 5, 5 }, { 5, 29 }, { 53, 29 }, { 29, 53 }, { 29, 5 }, { 31, 29 }, { 31, 5 }, { 33, 29 }, { 33, 5 }, { 35, 29 }, { 35, 5 }, { 37, 29 }, { 37, 5 }, { 39, 29 }, { 39, 5 }, { 41, 29 }, { 41, 5 }, { 43, 29 }, { 43, 5 }, { 45, 29 }, { 45, 5 }, { 47, 29 }, { 47, 5 }, { 49, 29 }, { 49, 5 }, { 51, 29 }, { 51, 5 }, { 0, 3 }, { 0, 15 }, { 6, 18 }, { 12, 15 }, { 12, 3 }, { 6, 0 }, { 0, 3 }, { 12, 15 }, { 0, 0 }, { 4, 18 }, { 7, 18 }, { 7, 0 }, { 12, 0 }, { 12, 9 }, { 2, 9 }, { 7, 18 }, { 12, 18 }, { 0, 11 }, { 6, 11 }, { 6, 0 }, { 0, 0 }, { 2, 5 }, { 13, 5 }, { 13, 8 }, { 10, 11 }, { 7, 8 }, { 7, 2 }, { 9, 0 }, { 13, 0 }, { 0, -5 }, { 18, -5 }, { 0, -6 }, { 5, 0 }, { 0, -12 }, { 10, 0 }, { 0, -18 }, { 15, 0 }, { 0, -24 }, { 20, 0 }, { 0, -30 }, { 25, 0 }, { 0, -36 }, { 30, 0 }, { 0, -42 }, { 35, 0 }, { 0, -48 }, { 40, 0 }, { 5, -48 }, { 45, 0 }, { 10, -48 }, { 48, -3 }, { 15, -48 }, { 48, -9 }, { 20, -48 }, { 48, -15 }, { 25, -48 }, { 48, -21 }, { 30, -48 }, { 48, -27 }, { 35, -48 }, { 48, -33 }, { 40, -48 }, { 48, -39 }, { 45, -48 }, { 48, -45 }, { 53, 0 }, { 48, 6 }, { 58, 0 }, { 48, 12 }, { 63, 0 }, { 48, 18 }, { 68, 0 }, { 48, 24 }, { 73, 0 }, { 48, 30 }, { 78, 0 }, { 48, 36 }, { 83, 0 }, { 48, 42 }, { 88, 0 }, { 48, 48 }, { 93, 0 }, { 53, 48 }, { 96, 3 }, { 58, 48 }, { 96, 9 }, { 63, 48 }, { 96, 15 }, { 68, 48 }, { 96, 21 }, { 73, 48 }, { 96, 27 }, { 78, 48 }, { 96, 33 }, { 83, 48 }, { 96, 39 }, { 88, 48 }, { 96, 45 }, { 93, 48 }, { 48, 44 }, { 0, 44 }, { 48, 40 }, { 0, 40 }, { 48, 36 }, { 0, 36 }, { 48, 32 }, { 0, 32 }, { 48, 28 }, { 0, 28 }, { 48, 24 }, { 0, 24 }, { 48, 20 }, { 0, 20 }, { 48, 16 }, { 0, 16 }, { 48, 12 }, { 0, 12 }, { 48, 8 }, { 0, 8 }, { 48, 4 }, { 0, 4 }, { 0, 0 }, { 12, 10 }, { 12, 8 }, { 9, 10 }, { 3, 10 }, { 0, 8 }, { 0, 2 }, { 3, 0 }, { 9, 0 }, { 12, 2 }, { 12, 8 }, { -15, 23 }, { -15, 23 }, { -9, 23 }, { -9, 23 }, { -12, 23 }, { -12, 23 }, { -18, 16 }, { -15, 18 }, { -9, 16 }, { -6, 18 }, { -12, 17 }, { -12, 17 }, { -36, 23 }, { -30, 26 }, { -24, 26 }, { -18, 23 }, { -12, 23 }, { -6, 26 }, { 0, 0 }, { 0, 18 }, { 0, 9 }, { 12, 9 }, { -36, 16 }, { -30, 18 }, { -24, 18 }, { -18, 16 }, { -12, 16 }, { -6, 18 }, { 0, 16 }, { 3, 18 }, { 9, 16 }, { 12, 18 } };

static struct {
	int16_t start, num;
	int16_t min_x, max_x, min_y, max_y;
} hp1345_meta[] = { { 0, 0, 0, 0, 0, 0 }, { 0, 25, 0, 45, 0, 27 }, { 25, 14, 0, 12, -7, 18 }, { 0, 0, 0, 0, 0, 0 }, { 39, 2, 0, 0, 0, 4 }, { 41, 2, 0, 0, -4, 0 }, { 43, 2, -4, 0, 0, 0 }, { 45, 2, 0, 4, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 47, 2, -4, 4, 0, 0 }, { 49, 2, 0, 0, -4, 4 }, { 51, 8, -5, 5, -5, 5 }, { 59, 9, -5, 5, -5, 5 }, { 68, 5, 0, 12, 0, 18 }, { 73, 5, 0, 12, 3, 15 }, { 78, 5, 0, 12, 0, 18 }, { 83, 5, 0, 12, 3, 15 }, { 88, 4, 0, 13, 0, 20 }, { 92, 8, 0, 12, 0, 14 }, { 100, 4, 0, 12, 0, 15 }, { 104, 8, 0, 13, -7, 11 }, { 112, 9, 4, 11, 16, 23 }, { 121, 10, 0, 13, 0, 16 }, { 131, 9, 0, 13, -7, 12 }, { 140, 7, 0, 12, 0, 18 }, { 147, 13, 0, 12, 0, 18 }, { 160, 6, 0, 12, 0, 18 }, { 0, 0, 0, 12, 0, 18 }, { 166, 4, 6, 6, 0, 18 }, { 170, 4, 3, 8, 14, 18 }, { 174, 8, 0, 12, 0, 18 }, { 182, 14, 0, 12, -1, 19 }, { 196, 12, 0, 12, 0, 18 }, { 208, 9, 0, 12, 0, 18 }, { 217, 3, 5, 7, 14, 18 }, { 220, 4, 6, 12, -2, 20 }, { 224, 4, 0, 6, -2, 20 }, { 228, 6, 0, 12, 2, 16 }, { 234, 4, 0, 12, 2, 16 }, { 238, 3, 4, 6, -4, 1 }, { 241, 2, 0, 12, 9, 9 }, { 243, 3, 6, 6, 0, 0 }, { 246, 2, 0, 12, 0, 18 }, { 248, 11, 0, 12, 0, 18 }, { 259, 5, 3, 9, 0, 18 }, { 264, 8, 0, 12, 0, 18 }, { 272, 13, 0, 12, 0, 18 }, { 285, 4, 0, 12, 0, 18 }, { 289, 10, 0, 12, 0, 18 }, { 299, 11, 0, 12, 0, 18 }, { 310, 3, 0, 12, 0, 18 }, { 313, 16, 0, 12, 0, 19 }, { 329, 11, 0, 12, 0, 18 }, { 340, 4, 6, 6, 4, 14 }, { 344, 5, 5, 7, -4, 10 }, { 349, 3, 0, 12, 0, 18 }, { 352, 4, 0, 12, 4, 14 }, { 356, 3, 0, 12, 0, 18 }, { 359, 9, 0, 12, 0, 18 }, { 368, 12, 0, 12, 0, 18 }, { 380, 5, 0, 12, 0, 18 }, { 385, 12, 0, 12, 0, 18 }, { 397, 8, 0, 12, 0, 18 }, { 405, 7, 0, 12, 0, 18 }, { 412, 7, 0, 12, 0, 18 }, { 419, 5, 0, 12, 0, 18 }, { 424, 10, 0, 12, 0, 18 }, { 434, 6, 0, 12, 0, 18 }, { 440, 6, 2, 10, 0, 18 }, { 446, 7, 0, 12, 0, 18 }, { 453, 6, 0, 12, 0, 18 }, { 459, 4, 0, 12, 0, 18 }, { 463, 5, 0, 12, 0, 18 }, { 468, 4, 0, 12, 0, 18 }, { 472, 9, 0, 12, 0, 18 }, { 481, 7, 0, 12, 0, 18 }, { 488, 11, 0, 14, -2, 18 }, { 499, 9, 0, 12, 0, 18 }, { 508, 12, 0, 12, 0, 18 }, { 520, 4, 0, 12, 0, 18 }, { 524, 6, 0, 12, 0, 18 }, { 530, 3, 0, 12, 0, 18 }, { 533, 5, 0, 12, 0, 18 }, { 538, 4, 0, 12, 0, 18 }, { 542, 5, 0, 12, 0, 18 }, { 547, 5, 0, 12, 0, 18 }, { 552, 4, 6, 12, -2, 20 }, { 556, 2, 0, 12, 0, 18 }, { 558, 4, 0, 6, -2, 20 }, { 562, 3, 0, 12, 7, 16 }, { 565, 2, -18, 0, -5, -5 }, { 567, 3, 5, 7, 14, 18 }, { 570, 11, 0, 13, 0, 12 }, { 581, 8, 0, 12, 0, 18 }, { 589, 6, 0, 11, 0, 11 }, { 595, 8, 0, 12, 0, 18 }, { 603, 9, 0, 12, 0, 12 }, { 612, 6, 0, 12, 0, 18 }, { 618, 10, 0, 11, -7, 11 }, { 628, 6, 0, 12, 0, 18 }, { 634, 5, 4, 7, 0, 18 }, { 639, 6, 0, 8, -7, 18 }, { 645, 6, 0, 12, 0, 18 }, { 651, 5, 3, 9, 0, 18 }, { 656, 10, 0, 12, 0, 12 }, { 666, 6, 0, 12, 0, 11 }, { 672, 7, 0, 12, 0, 11 }, { 679, 8, 0, 12, -7, 11 }, { 687, 9, 0, 13, -8, 11 }, { 696, 5, 0, 12, 0, 11 }, { 701, 8, 0, 12, 0, 12 }, { 709, 6, 0, 12, 0, 18 }, { 715, 5, 0, 12, 0, 11 }, { 720, 3, 0, 12, 0, 11 }, { 723, 5, 0, 12, 0, 11 }, { 728, 4, 0, 11, 0, 11 }, { 732, 4, 0, 12, -7, 11 }, { 736, 4, 0, 12, 0, 11 }, { 740, 7, 4, 12, -2, 20 }, { 747, 4, 6, 6, 0, 18 }, { 751, 7, 0, 8, -2, 20 }, { 758, 5, 0, 53, 0, 53 }, { 763, 14, 0, 12, 0, 18 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 777, 12, -48, 0, -55, 0 }, { 0, 0, 0, 0, 0, 0 }, { 789, 2, 0, 0, 0, 9 }, { 791, 2, 0, 0, -9, 0 }, { 793, 2, -9, 0, 0, 0 }, { 795, 2, 0, 9, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 797, 2, -9, 9, 0, 0 }, { 799, 2, 0, 0, -9, 9 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 801, 5, 0, 53, 0, 39 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 806, 43, 0, 58, 0, 80 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 849, 78, 0, 96, -66, 66 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 927, 2, 6, 6, 13, 18 }, { 929, 2, -17, -8, 15, 18 }, { 931, 2, -17, -7, 15, 19 }, { 933, 3, -17, -7, 15, 18 }, { 936, 4, -15, -9, 17, 17 }, { 940, 4, -18, -6, 23, 26 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 944, 10, 0, 11, -10, 11 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 954, 4, 12, 12, 0, 18 }, { 958, 8, 0, 12, 0, 18 }, { 0, 0, 0, 0, 0, 0 }, { 966, 13, 0, 12, 0, 18 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 979, 36, 0, 58, 0, 58 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 1015, 8, 0, 12, 0, 18 }, { 1023, 9, 0, 12, 0, 18 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 1032, 12, 0, 13, 0, 11 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 1044, 2, 0, 18, -5, -5 }, { 0, 0, 0, 0, 0, 0 }, { 1046, 90, 0, 96, -48, 48 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 1136, 11, 0, 12, 0, 10 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 0, 0, 0, 0, 0, 0 }, { 1147, 4, -15, -9, 23, 23 }, { 0, 0, 0, 0, 0, 0 }, { 1151, 2, -12, -12, 23, 23 }, { 0, 0, 0, 0, 0, 0 }, { 1153, 4, -18, -6, 16, 18 }, { 0, 0, 0, 0, 0, 0 }, { 1157, 2, -12, -12, 17, 17 }, { 0, 0, 0, 0, 0, 0 }, { 1159, 6, -36, -6, 23, 26 }, { 1165, 4, 0, 12, 0, 18 }, { 1169, 6, -36, -6, 16, 18 }, { 1175, 4, 0, 12, 16, 18 }, { 0, 0, 0, 0, 0, 0 } };

bool _prep_hp1345_glyph(PoolVector2Array &p_data, uint8_t p_idx, const Point2 &p_pos, const Size2 &p_scale) {
	const int start = hp1345_meta[p_idx].start;
	const int num = hp1345_meta[p_idx].num;
	if (num == 0) {
		return false;
	}
	const int offset_x = hp1345_meta[p_idx].min_x;
	Point2 orig;
	for (int j = start; j < start + num; j++) {
		const Point2 xy = { p_pos.x + (hp1345_points[j].x - offset_x) * p_scale.x, p_pos.y - hp1345_points[j].y * p_scale.y };
		if (hp1345_ops[j]) {
			if (orig == xy) {
				// point
				p_data.push_back(xy + Vector2(-p_scale.x, 0));
				p_data.push_back(xy + Vector2(0, p_scale.y));
				p_data.push_back(xy + Vector2(0, p_scale.y));
				p_data.push_back(xy + Vector2(p_scale.x, 0));
				p_data.push_back(xy + Vector2(p_scale.x, 0));
				p_data.push_back(xy + Vector2(0, -p_scale.y));
				p_data.push_back(xy + Vector2(0, -p_scale.y));
				p_data.push_back(xy + Vector2(-p_scale.x, 0));
			} else {
				p_data.push_back(orig);
				p_data.push_back(xy);
			}
		};
		orig = xy;
	}
	return true;
}

void _draw_hp1345_text(Ref<ArrayMesh> &p_mesh, const String &p_text, const Point2 &p_pos, const Color &p_color, const Size2 &p_scale) {
	if (p_text.empty()) {
		return;
	}
	PoolVector2Array data;
	Point2 pos = p_pos;
	for (int i = 0; i < p_text.length(); i++) {
		const CharType code = p_text[i];
		if (_prep_hp1345_glyph(data, code, pos, p_scale) || code == ' ') {
			const real_t adv = MAX(2, hp1345_meta[code].max_x - hp1345_meta[code].min_x) * p_scale.x;
			pos += Point2(adv + 2, 0);
		}
	}
	Array mesh_array;
	mesh_array.resize(VS::ARRAY_MAX);
	mesh_array[VS::ARRAY_VERTEX] = data;
	PoolColorArray colors;
	colors.resize(data.size());
	colors.fill(p_color);
	mesh_array[VS::ARRAY_COLOR] = colors;
	p_mesh->add_surface_from_arrays(Mesh::PRIMITIVE_LINES, mesh_array);
}

void _draw_hp1345_text(Ref<ArrayMesh> &p_mesh, const String &p_text, const Point2 &p_pos, const Size2 &p_scale) {
	if (p_text.empty()) {
		return;
	}
	PoolVector2Array data;
	Point2 pos = p_pos;
	for (int i = 0; i < p_text.length(); i++) {
		const CharType code = p_text[i];
		if (_prep_hp1345_glyph(data, code, pos, p_scale) || code == ' ') {
			const real_t adv = MAX(2, hp1345_meta[code].max_x - hp1345_meta[code].min_x) * p_scale.x;
			pos += Point2(adv + 2, 0);
		}
	}
	Array mesh_array;
	mesh_array.resize(VS::ARRAY_MAX);
	mesh_array[VS::ARRAY_VERTEX] = data;
	p_mesh->add_surface_from_arrays(Mesh::PRIMITIVE_LINES, mesh_array);
}

Size2 _size_hp1345_text(const String &p_text, const Size2 &p_scale) {
	if (p_text.empty()) {
		return Size2();
	}
	real_t text_width = 0, min_y = 999, max_y = -999;
	for (int i = 0; i < p_text.length(); i++) {
		const CharType code = p_text[i];
		if (hp1345_meta[code].num == 0 && code != ' ') {
			continue;
		}
		text_width += 2 + MAX(2, hp1345_meta[code].max_x - hp1345_meta[code].min_x) * p_scale.x;
		if (hp1345_meta[code].min_y < min_y) {
			min_y = hp1345_meta[code].min_y;
		}
		if (hp1345_meta[code].max_y > max_y) {
			max_y = hp1345_meta[code].max_y;
		}
	}
	return Size2(text_width, p_scale.y * (max_y - min_y));
}
